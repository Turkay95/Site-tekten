<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2">Ajouter un composant</h1>
  <div>
    <a href="/admin/components" class="btn btn-sm btn-outline-secondary">
      <i class="bi bi-arrow-left"></i> Retour à la liste
    </a>
  </div>
</div>

<div class="card">
  <div class="card-body">
    <form action="/admin/components/add" method="POST" enctype="multipart/form-data">
      <div class="row">
        <div class="col-md-6">
          <div class="mb-3">
            <label for="name" class="form-label">Nom <span class="text-danger">*</span></label>
            <input type="text" class="form-control" id="name" name="name" required>
          </div>

          <div class="mb-3">
            <label for="type" class="form-label">Type de composant <span class="text-danger">*</span></label>
            <select class="form-select" id="type" name="type" required>
              <option value="" disabled selected>Choisir un type</option>
              <option value="CPU / Processeur">CPU / Processeur</option>
              <option value="Carte mere">Carte mère</option>
              <option value="RAM">Mémoire RAM</option>
              <option value="Carte graphique GPU">Carte graphique (GPU)</option>
              <option value="SSD / Stockage">SSD / Stockage</option>
              <option value="Boitier PC">Boîtier PC</option>
              <option value="Alimentation PSU">Alimentation (PSU)</option>
              <option value="Refroidissement / Cooling">Refroidissement</option>
            </select>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="price" class="form-label">Prix (€) <span class="text-danger">*</span></label>
                <div class="input-group">
                  <input type="number" class="form-control" id="price" name="price" step="0.01" min="0" required>
                  <span class="input-group-text">€</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="stock" class="form-label">Stock <span class="text-danger">*</span></label>
                <input type="number" class="form-control" id="stock" name="stock" min="0" value="0" required>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="brand" class="form-label">Marque</label>
                <input type="text" class="form-control" id="brand" name="brand">
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="weight" class="form-label">Poids (kg)</label>
                <input type="number" class="form-control" id="weight" name="weight" step="0.01" min="0">
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label for="material" class="form-label">Format / Matériau</label>
            <input type="text" class="form-control" id="material" name="material" placeholder="ATX, Micro-ATX, ITX, aluminium, plastique, ...">
          </div>

          <div class="mb-3">
            <label for="compatibleWith" class="form-label">Compatible avec</label>
            <input type="text" class="form-control" id="compatibleWith" name="compatibleWith" placeholder="Socket AM5, LGA1700, DDR5, carte mère ASUS B650, ...">
          </div>

          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="published" name="published">
            <label class="form-check-label" for="published">Publié (visible sur le configurateur)</label>
          </div>
        </div>

        <div class="col-md-6">
          <div class="mb-3">
            <label for="image" class="form-label">Image</label>
            <div class="border rounded p-3 text-center bg-light" style="height: 200px; display: flex; align-items: center; justify-content: center;">
              <div class="text-center" id="imagePreviewContainer">
                <i class="bi bi-image fs-1 text-muted mb-2 d-block"></i>
                <p class="text-muted mb-0">Aperçu de l'image</p>
              </div>
            </div>
            <input type="file" class="form-control mt-2" id="image" name="image" accept="image/*" onchange="previewImage(this)">
            <div class="form-text">Formats acceptés : JPG, PNG, GIF (max 5Mo)</div>
          </div>
        </div>
      </div>

      <div class="mb-3">
        <label for="description" class="form-label">Description <span class="text-danger">*</span></label>
        <textarea class="form-control" id="description" name="description" rows="5" required></textarea>
      </div>

      <div class="d-flex justify-content-between">
        <a href="/admin/components" class="btn btn-outline-secondary">Annuler</a>
        <button type="submit" class="btn btn-success">
          <i class="bi bi-save"></i> Enregistrer
        </button>
      </div>
    </form>
  </div>
</div>

<script>
function previewImage(input) {
  const file = input.files[0];
  const reader = new FileReader();
  const container = document.getElementById('imagePreviewContainer');
  reader.onload = function(e) {
    container.innerHTML = `<img src="${e.target.result}" alt="Aperçu" style="max-width: 100%; max-height: 200px; object-fit: contain;">`;
  }
  if (file) reader.readAsDataURL(file);
}
</script>
